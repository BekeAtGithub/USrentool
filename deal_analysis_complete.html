<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Deal Analysis Cheat Sheet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .phase-header {
            background: linear-gradient(135deg, #a2c4c9 0%, #8ab4ba 100%);
            color: #1a1a1a;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 1.3em;
            font-weight: 700;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .form-field {
            display: flex;
            flex-direction: column;
        }
        
        .form-field label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tooltip {
            cursor: help;
            background: #667eea;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            position: relative;
        }
        
        .tooltip:hover::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2c3e50;
            color: white;
            padding: 10px;
            border-radius: 5px;
            width: 300px;
            font-size: 0.9em;
            z-index: 1000;
            margin-bottom: 5px;
            font-weight: normal;
            line-height: 1.4;
        }
        
        .form-field input,
        .form-field textarea {
            padding: 12px;
            border: 2px solid #b6d7a8;
            border-radius: 5px;
            font-size: 1em;
            background: #f0f8f0;
            transition: all 0.3s;
        }
        
        .form-field input:focus,
        .form-field textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }
        
        .form-field textarea {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .calculator-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .calc-input-section,
        .calc-results-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .calc-results-section h3 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 5px;
            background: #f8f9fa;
        }

        .metric.good {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }

        .metric.warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }

        .metric.poor {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }

        .metric-label {
            font-weight: 600;
            color: #2c3e50;
        }

        .metric-value {
            font-size: 1.2em;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .tab {
                font-size: 0.9em;
                padding: 15px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèòÔ∏è Rental Property Investment Calculator</h1>
            <p>Quick Analysis Tool - Plug in Numbers & See if the Deal Works</p>
        </div>

        <!-- SECTION 1: BASIC PROPERTY INFO -->
        <div class="section">
            <div class="phase-header">üè† Basic Property Information</div>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Property Address
                        <span class="tooltip" data-tip="Full street address of the property">?</span>
                    </label>
                    <input type="text" id="propertyAddress" placeholder="123 Main Street, City, State ZIP">
                </div>

                <div class="form-field">
                    <label>
                        Number of Units
                        <span class="tooltip" data-tip="Total number of rentable units in the property">?</span>
                    </label>
                    <input type="number" id="numUnits" placeholder="3">
                </div>

                <div class="form-field">
                    <label>
                        Asking Price ($)
                        <span class="tooltip" data-tip="Seller's asking price for the property">?</span>
                    </label>
                    <input type="number" id="askingPrice" placeholder="150000">
                </div>

                <div class="form-field">
                    <label>
                        Current Property Tax/Yr ($)
                        <span class="tooltip" data-tip="Annual property tax amount currently being paid">?</span>
                    </label>
                    <input type="number" id="currentTax" placeholder="3000">
                </div>

                <div class="form-field">
                    <label>
                        Monthly Utilities Cost ($)
                        <span class="tooltip" data-tip="Total monthly utilities you'll pay as owner (gas, electric, water, trash, etc.)">?</span>
                    </label>
                    <input type="number" id="utilities" placeholder="260" step="0.01">
                </div>

                <div class="form-field">
                    <label>
                        Estimated Repairs Needed ($)
                        <span class="tooltip" data-tip="Estimated cost for any deferred maintenance or immediate repairs">?</span>
                    </label>
                    <input type="number" id="deferredMaint" placeholder="5000" step="0.01">
                </div>
            </div>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Unit + Rent Breakdown
                        <span class="tooltip" data-tip="List each unit with bed/bath count and current monthly rent">?</span>
                    </label>
                    <textarea id="unitBreakdown" placeholder="Unit 1: 2br/1ba - $800/mo&#10;Unit 2: 2br/1ba - $750/mo&#10;Unit 3: 4br/2ba - $1200/mo"></textarea>
                </div>
            </div>

        </div>

        <!-- SECTION 2: MARKET ANALYSIS -->
        <div class="section">
            <div class="phase-header">üìä Market Analysis & Valuation</div>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Current Assessed Value ($)
                        <span class="tooltip" data-tip="The current assessed value from county records">?</span>
                    </label>
                    <input type="number" id="assessedValue" placeholder="120000">
                </div>

                <div class="form-field">
                    <label>
                        Estimated Reassessment ($)
                        <span class="tooltip" data-tip="What will the property be reassessed at after purchase?">?</span>
                    </label>
                    <input type="number" id="estReassessment" placeholder="130000">
                </div>

                <div class="form-field">
                    <label>
                        Est. Future Property Tax/Yr ($)
                        <span class="tooltip" data-tip="Estimated annual property tax after reassessment">?</span>
                    </label>
                    <input type="number" id="futureTax" placeholder="3250">
                </div>

                <div class="form-field">
                    <label>
                        Estimated Market Value ($)
                        <span class="tooltip" data-tip="What do you estimate this property to be worth based on comparable sales">?</span>
                    </label>
                    <input type="number" id="marketValue" placeholder="140000">
                </div>

                <div class="form-field">
                    <label>
                        Property Sqft
                        <span class="tooltip" data-tip="Total square footage of the property">?</span>
                    </label>
                    <input type="number" id="sqft" placeholder="2800">
                </div>

                <div class="form-field">
                    <label>
                        Year Built
                        <span class="tooltip" data-tip="Year the property was built">?</span>
                    </label>
                    <input type="number" id="yearBuilt" placeholder="1918">
                </div>
            </div>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Market Rent Breakdown
                        <span class="tooltip" data-tip="What can each unit rent for at market rates? Research comparable rentals in the area.">?</span>
                    </label>
                    <textarea id="marketRents" placeholder="Unit 1: 2br/1ba - $850/mo&#10;Unit 2: 2br/1ba - $850/mo&#10;Unit 3: 4br/2ba - $1250/mo"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Comparable Sales Notes
                        <span class="tooltip" data-tip="Notes on recent comparable property sales in the area">?</span>
                    </label>
                    <textarea id="comps" placeholder="Recent comp sales and listings"></textarea>
                </div>
            </div>

        </div>

        <!-- SECTION 3: PROPERTY CONDITION -->
        <div class="section">
            <div class="phase-header">üîß Property Condition Assessment</div>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Roof Condition & Age
                        <span class="tooltip" data-tip="Type of roof, age, condition, estimated years remaining">?</span>
                    </label>
                    <textarea id="roof" placeholder="Comp shingle, 20 years old, 5-10 years remaining"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Foundation & Basement
                        <span class="tooltip" data-tip="Any moisture, cracks, or structural issues?">?</span>
                    </label>
                    <textarea id="foundation" placeholder="Dry basement, no major cracks or bowing"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        HVAC Condition & Age
                        <span class="tooltip" data-tip="Type, number of units, age, condition">?</span>
                    </label>
                    <textarea id="hvac" placeholder="1 furnace, 12 years old, good condition"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Water Heaters
                        <span class="tooltip" data-tip="Number of units and age of each">?</span>
                    </label>
                    <textarea id="waterHeaters" placeholder="3 units: 5, 5, and 12 years old"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Electrical System
                        <span class="tooltip" data-tip="Breaker boxes or fuses? Wiring type? Up to code?">?</span>
                    </label>
                    <textarea id="electrical" placeholder="3 breaker boxes, 100a each, romex wiring, up to code"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Plumbing System
                        <span class="tooltip" data-tip="Pipe material (copper, PVC, galvanized)? Any issues?">?</span>
                    </label>
                    <textarea id="plumbing" placeholder="Mix of galvanized and copper, no current leaks"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Windows Condition
                        <span class="tooltip" data-tip="Type (wood, vinyl), condition, any replacements needed?">?</span>
                    </label>
                    <textarea id="windows" placeholder="Mix of vinyl dual-pane and older wood windows"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        Kitchen/Bath Condition
                        <span class="tooltip" data-tip="Overall condition, any updates needed?">?</span>
                    </label>
                    <textarea id="kitchens" placeholder="Older but well-maintained, may need updates on turnover"></textarea>
                </div>
            </div>

            <h3 style="margin: 25px 0 15px 0; color: #2c3e50; border-bottom: 2px solid #dee2e6; padding-bottom: 10px;">üìù Additional Notes</h3>

            <div class="form-grid">
                <div class="form-field">
                    <label>
                        Tenant Information
                        <span class="tooltip" data-tip="Lease terms, payment history, condition of units">?</span>
                    </label>
                    <textarea id="tenantTerms" placeholder="Unit 1: Month-to-month, 3 years, good tenant&#10;Unit 2: Month-to-month, 8 years, excellent tenant&#10;Unit 3: Annual lease, 12 years, fair tenant"></textarea>
                </div>

                <div class="form-field">
                    <label>
                        General Property Notes
                        <span class="tooltip" data-tip="Any other important information about the property">?</span>
                    </label>
                    <textarea id="propertyNotes" placeholder="Additional observations, concerns, or opportunities"></textarea>
                </div>
            </div>

        </div>

        <!-- SECTION 4: FINANCIAL CALCULATOR -->
        <div class="section">
            <div class="phase-header">üìä Financial Analysis & ROI Calculator</div>

            <div class="calculator-grid">
                <div class="calc-input-section">
                    <h3>Property Details</h3>
                    <div class="form-field">
                        <label>Sale Price ($)</label>
                        <input type="number" id="calcSalePrice" value="70000" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Down Payment (%)</label>
                        <input type="number" id="calcDownPayment" value="25" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Interest Rate (%)</label>
                        <input type="number" id="calcInterestRate" value="7.5" step="0.1" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Loan Term (years)</label>
                        <input type="number" id="calcLoanTerm" value="30" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Closing Costs ($)</label>
                        <input type="number" id="calcClosingCosts" value="3000" oninput="calculateInvestment()">
                    </div>

                    <h3 style="margin-top: 25px;">Income & Expenses</h3>
                    <div class="form-field">
                        <label>Gross Monthly Rents ($)</label>
                        <input type="number" id="calcGrossRents" value="1000" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Vacancy Rate (%)</label>
                        <input type="number" id="calcVacancy" value="5" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Property Management (%)</label>
                        <input type="number" id="calcPropMgmt" value="10" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Annual Property Tax ($)</label>
                        <input type="number" id="calcPropTax" value="840" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Annual Insurance ($)</label>
                        <input type="number" id="calcInsurance" value="600" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Maintenance Reserve (%)</label>
                        <input type="number" id="calcMaintenance" value="10" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Cash Reserves (%)</label>
                        <input type="number" id="calcReserves" value="5" oninput="calculateInvestment()">
                    </div>
                    <div class="form-field">
                        <label>Rent Growth Rate (%)</label>
                        <input type="number" id="calcRentGrowth" value="3" step="0.1" oninput="calculateInvestment()">
                    </div>
                </div>

                <div class="calc-results-section">
                    <h3>Investment Metrics</h3>
                    <div id="metricsDisplay"></div>

                    <h3 style="margin-top: 25px;">Monthly Expense Breakdown</h3>
                    <div id="expenseBreakdown"></div>
                </div>
            </div>

            <div id="projectionTables" style="margin-top: 30px;"></div>
        </div>

        <!-- ACTION BUTTONS -->
        <div class="action-buttons" style="position: sticky; bottom: 0; background: white; padding: 20px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 100;">
            <button class="btn btn-primary" onclick="saveData()">üíæ Save All Data</button>
            <button class="btn btn-success" onclick="exportData()">üì• Export Analysis</button>
        </div>
    </div>

    <script>
        // Save data to localStorage
        function saveData() {
            const formData = {
                // Phase 1
                propertyAddress: document.getElementById('propertyAddress').value,
                numUnits: document.getElementById('numUnits').value,
                askingPrice: document.getElementById('askingPrice').value,
                currentTax: document.getElementById('currentTax').value,
                utilities: document.getElementById('utilities').value,
                deferredMaint: document.getElementById('deferredMaint').value,
                unitBreakdown: document.getElementById('unitBreakdown').value,

                // Phase 2
                assessedValue: document.getElementById('assessedValue').value,
                estReassessment: document.getElementById('estReassessment').value,
                futureTax: document.getElementById('futureTax').value,
                marketValue: document.getElementById('marketValue').value,
                sqft: document.getElementById('sqft').value,
                yearBuilt: document.getElementById('yearBuilt').value,
                marketRents: document.getElementById('marketRents').value,
                comps: document.getElementById('comps').value,

                // Phase 3
                roof: document.getElementById('roof').value,
                foundation: document.getElementById('foundation').value,
                hvac: document.getElementById('hvac').value,
                waterHeaters: document.getElementById('waterHeaters').value,
                electrical: document.getElementById('electrical').value,
                plumbing: document.getElementById('plumbing').value,
                windows: document.getElementById('windows').value,
                kitchens: document.getElementById('kitchens').value,
                tenantTerms: document.getElementById('tenantTerms').value,
                propertyNotes: document.getElementById('propertyNotes').value,

                // Calculator
                calcSalePrice: document.getElementById('calcSalePrice').value,
                calcDownPayment: document.getElementById('calcDownPayment').value,
                calcInterestRate: document.getElementById('calcInterestRate').value,
                calcLoanTerm: document.getElementById('calcLoanTerm').value,
                calcClosingCosts: document.getElementById('calcClosingCosts').value,
                calcGrossRents: document.getElementById('calcGrossRents').value,
                calcVacancy: document.getElementById('calcVacancy').value,
                calcPropMgmt: document.getElementById('calcPropMgmt').value,
                calcPropTax: document.getElementById('calcPropTax').value,
                calcInsurance: document.getElementById('calcInsurance').value,
                calcMaintenance: document.getElementById('calcMaintenance').value,
                calcReserves: document.getElementById('calcReserves').value,
                calcRentGrowth: document.getElementById('calcRentGrowth').value
            };

            localStorage.setItem('dealAnalysisData', JSON.stringify(formData));
            alert('‚úÖ Progress saved successfully!');
        }

        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('dealAnalysisData');
            if (savedData) {
                const formData = JSON.parse(savedData);
                Object.keys(formData).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = formData[key];
                    }
                });
            }
        }

        // Export data as JSON
        function exportData() {
            saveData(); // Save first
            const savedData = localStorage.getItem('dealAnalysisData');
            if (savedData) {
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(savedData);
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                const address = document.getElementById('propertyAddress').value || 'property';
                downloadAnchorNode.setAttribute("download", `deal_analysis_${address.replace(/[^a-z0-9]/gi, '_')}.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            }
        }

        // Financial Calculator
        function calculateInvestment() {
            const salePrice = parseFloat(document.getElementById('calcSalePrice').value) || 0;
            const downPaymentPct = parseFloat(document.getElementById('calcDownPayment').value) || 0;
            const interestRate = parseFloat(document.getElementById('calcInterestRate').value) || 0;
            const loanTerm = parseFloat(document.getElementById('calcLoanTerm').value) || 0;
            const closingCosts = parseFloat(document.getElementById('calcClosingCosts').value) || 0;
            const grossRents = parseFloat(document.getElementById('calcGrossRents').value) || 0;
            const vacancyPct = parseFloat(document.getElementById('calcVacancy').value) || 0;
            const propMgmtPct = parseFloat(document.getElementById('calcPropMgmt').value) || 0;
            const propTax = parseFloat(document.getElementById('calcPropTax').value) || 0;
            const insurance = parseFloat(document.getElementById('calcInsurance').value) || 0;
            const maintenancePct = parseFloat(document.getElementById('calcMaintenance').value) || 0;
            const reservesPct = parseFloat(document.getElementById('calcReserves').value) || 0;
            const rentGrowth = parseFloat(document.getElementById('calcRentGrowth').value) || 0;

            // Calculate loan details
            const downPayment = salePrice * (downPaymentPct / 100);
            const loanAmount = salePrice - downPayment;
            const monthlyRate = (interestRate / 100) / 12;
            const numPayments = loanTerm * 12;

            // Monthly mortgage payment (P&I)
            let monthlyPayment = 0;
            if (monthlyRate > 0 && numPayments > 0) {
                monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numPayments)) /
                                (Math.pow(1 + monthlyRate, numPayments) - 1);
            }

            // Monthly income
            const monthlyGrossRents = grossRents;
            const monthlyVacancy = monthlyGrossRents * (vacancyPct / 100);
            const effectiveGrossIncome = monthlyGrossRents - monthlyVacancy;

            // Monthly expenses
            const monthlyPropMgmt = effectiveGrossIncome * (propMgmtPct / 100);
            const monthlyPropTax = propTax / 12;
            const monthlyInsurance = insurance / 12;
            const monthlyMaintenance = monthlyGrossRents * (maintenancePct / 100);
            const monthlyReserves = monthlyGrossRents * (reservesPct / 100);

            const totalMonthlyExpenses = monthlyPropMgmt + monthlyPropTax + monthlyInsurance +
                                        monthlyMaintenance + monthlyReserves + monthlyPayment;

            // NOI (before debt service)
            const monthlyNOI = effectiveGrossIncome - (monthlyPropMgmt + monthlyPropTax +
                              monthlyInsurance + monthlyMaintenance + monthlyReserves);
            const annualNOI = monthlyNOI * 12;

            // Cash flow
            const monthlyCashFlow = effectiveGrossIncome - totalMonthlyExpenses;
            const annualCashFlow = monthlyCashFlow * 12;

            // Total cash invested
            const totalInvested = downPayment + closingCosts;

            // Cap Rate
            const capRate = salePrice > 0 ? (annualNOI / salePrice) * 100 : 0;

            // Cash-on-Cash ROI
            const cashOnCashROI = totalInvested > 0 ? (annualCashFlow / totalInvested) * 100 : 0;

            // Debt Coverage Ratio
            const annualDebtService = monthlyPayment * 12;
            const dcr = annualDebtService > 0 ? annualNOI / annualDebtService : 0;

            // Display metrics
            displayMetrics(capRate, cashOnCashROI, dcr, monthlyCashFlow, annualCashFlow, monthlyNOI, annualNOI);

            // Display expense breakdown
            displayExpenseBreakdown({
                vacancy: monthlyVacancy,
                propMgmt: monthlyPropMgmt,
                propTax: monthlyPropTax,
                insurance: monthlyInsurance,
                maintenance: monthlyMaintenance,
                reserves: monthlyReserves,
                mortgage: monthlyPayment
            });

            // Generate projection tables
            generateProjectionTables(grossRents, rentGrowth, loanAmount, monthlyRate, monthlyPayment, totalInvested);
        }

        function displayMetrics(capRate, roi, dcr, monthlyCF, annualCF, monthlyNOI, annualNOI) {
            const metricsHTML = `
                <div class="metric ${capRate >= 8 ? 'good' : capRate >= 6 ? 'warning' : 'poor'}">
                    <span class="metric-label">Cap Rate</span>
                    <span class="metric-value">${capRate.toFixed(2)}%</span>
                </div>
                <div class="metric ${roi >= 15 ? 'good' : roi >= 8 ? 'warning' : 'poor'}">
                    <span class="metric-label">Cash-on-Cash ROI</span>
                    <span class="metric-value">${roi.toFixed(2)}%</span>
                </div>
                <div class="metric ${dcr >= 1.25 ? 'good' : dcr >= 1.0 ? 'warning' : 'poor'}">
                    <span class="metric-label">Debt Coverage Ratio</span>
                    <span class="metric-value">${dcr.toFixed(2)}</span>
                </div>
                ${dcr >= 1.25 ? '<div class="metric good"><span class="metric-label">‚úÖ Qualifies for Commercial Loan</span><span class="metric-value">DCR ‚â• 1.25</span></div>' : ''}
                <div class="metric ${monthlyCF > 0 ? 'good' : 'poor'}">
                    <span class="metric-label">Monthly Cash Flow</span>
                    <span class="metric-value">$${monthlyCF.toFixed(2)}</span>
                </div>
                <div class="metric ${annualCF > 0 ? 'good' : 'poor'}">
                    <span class="metric-label">Annual Cash Flow</span>
                    <span class="metric-value">$${annualCF.toFixed(2)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Monthly NOI</span>
                    <span class="metric-value">$${monthlyNOI.toFixed(2)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Annual NOI</span>
                    <span class="metric-value">$${annualNOI.toFixed(2)}</span>
                </div>
            `;
            document.getElementById('metricsDisplay').innerHTML = metricsHTML;
        }

        function displayExpenseBreakdown(expenses) {
            const total = Object.values(expenses).reduce((a, b) => a + b, 0);
            const expenseHTML = `
                <div class="metric"><span class="metric-label">Vacancy</span><span class="metric-value">$${expenses.vacancy.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Property Management</span><span class="metric-value">$${expenses.propMgmt.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Property Tax</span><span class="metric-value">$${expenses.propTax.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Insurance</span><span class="metric-value">$${expenses.insurance.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Maintenance</span><span class="metric-value">$${expenses.maintenance.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Reserves</span><span class="metric-value">$${expenses.reserves.toFixed(2)}</span></div>
                <div class="metric"><span class="metric-label">Mortgage (P&I)</span><span class="metric-value">$${expenses.mortgage.toFixed(2)}</span></div>
                <div class="metric good"><span class="metric-label"><strong>Total Monthly Expenses</strong></span><span class="metric-value"><strong>$${total.toFixed(2)}</strong></span></div>
            `;
            document.getElementById('expenseBreakdown').innerHTML = expenseHTML;
        }

        function generateProjectionTables(monthlyRent, rentGrowthRate, loanAmount, monthlyRate, monthlyPayment, totalInvested) {
            // 20-Year Rent Growth Projection
            let rentProjectionHTML = `
                <div class="calculator-section">
                    <h3>üìà 20-Year Rent Growth Projection (${rentGrowthRate}% Annual Growth)</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #2c3e50; color: white;">
                                <th style="padding: 12px; text-align: left;">Year</th>
                                <th style="padding: 12px; text-align: right;">Monthly Rent</th>
                                <th style="padding: 12px; text-align: right;">Annual Rent</th>
                                <th style="padding: 12px; text-align: right;">Cumulative Growth</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            let currentRent = monthlyRent;
            const growthMultiplier = 1 + (rentGrowthRate / 100);

            for (let year = 1; year <= 20; year++) {
                currentRent = monthlyRent * Math.pow(growthMultiplier, year);
                const annualRent = currentRent * 12;
                const cumulativeGrowth = ((currentRent - monthlyRent) / monthlyRent) * 100;

                const rowStyle = year % 2 === 0 ? 'background: #f8f9fa;' : '';
                rentProjectionHTML += `
                    <tr style="${rowStyle}">
                        <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">Year ${year}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6;">$${currentRent.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6;">$${annualRent.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; color: #28a745; font-weight: 600;">+${cumulativeGrowth.toFixed(1)}%</td>
                    </tr>
                `;
            }

            rentProjectionHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            // 5-Year Debt Paydown Summary
            let debtPaydownHTML = `
                <div class="calculator-section" style="margin-top: 20px;">
                    <h3>üí∞ 5-Year Debt Paydown Summary</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #2c3e50; color: white;">
                                <th style="padding: 12px; text-align: left;">Year</th>
                                <th style="padding: 12px; text-align: right;">Principal Paid</th>
                                <th style="padding: 12px; text-align: right;">Interest Paid</th>
                                <th style="padding: 12px; text-align: right;">Remaining Balance</th>
                                <th style="padding: 12px; text-align: right;">Equity Gained</th>
                                <th style="padding: 12px; text-align: right;">ROI on Paydown</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            let remainingBalance = loanAmount;
            let totalPrincipalPaid = 0;

            for (let year = 1; year <= 5; year++) {
                let yearlyPrincipal = 0;
                let yearlyInterest = 0;

                for (let month = 1; month <= 12; month++) {
                    const interestPayment = remainingBalance * monthlyRate;
                    const principalPayment = monthlyPayment - interestPayment;

                    yearlyPrincipal += principalPayment;
                    yearlyInterest += interestPayment;
                    remainingBalance -= principalPayment;
                }

                totalPrincipalPaid += yearlyPrincipal;
                const roiOnPaydown = totalInvested > 0 ? (totalPrincipalPaid / totalInvested) * 100 : 0;

                const rowStyle = year % 2 === 0 ? 'background: #f8f9fa;' : '';
                debtPaydownHTML += `
                    <tr style="${rowStyle}">
                        <td style="padding: 10px; border-bottom: 1px solid #dee2e6;">Year ${year}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; color: #28a745; font-weight: 600;">$${yearlyPrincipal.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; color: #dc3545;">$${yearlyInterest.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6;">$${remainingBalance.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; color: #28a745; font-weight: 600;">$${totalPrincipalPaid.toFixed(2)}</td>
                        <td style="padding: 10px; text-align: right; border-bottom: 1px solid #dee2e6; color: #667eea; font-weight: 600;">${roiOnPaydown.toFixed(2)}%</td>
                    </tr>
                `;
            }

            debtPaydownHTML += `
                        </tbody>
                    </table>
                    <p style="margin-top: 15px; color: #6c757d; font-style: italic;">
                        üí° <strong>Note:</strong> This shows how your equity builds through principal paydown over 5 years.
                        The ROI on Paydown shows the return on your initial investment from debt reduction alone, not including cash flow or appreciation.
                    </p>
                </div>
            `;

            document.getElementById('projectionTables').innerHTML = rentProjectionHTML + debtPaydownHTML;
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadData();
            calculateInvestment();
        });
    </script>
</body>
</html>

